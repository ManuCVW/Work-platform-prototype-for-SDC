const mobileMenuBtn=document.querySelector("#mobile-menu"),cerrarMenuBtn=document.querySelector("#cerrar-menu"),sidebar=document.querySelector(".sidebar");mobileMenuBtn&&mobileMenuBtn.addEventListener("click",(function(){sidebar.classList.add("mostrar")})),cerrarMenuBtn&&cerrarMenuBtn.addEventListener("click",(function(){sidebar.classList.add("ocultar"),setTimeout((()=>{sidebar.classList.remove("mostrar"),sidebar.classList.remove("ocultar")}),1e3)}));const anchoPantalla=document.body.clientWidth;function sleep(e){return new Promise((t=>setTimeout(t,e)))}var listBefore;window.addEventListener("resize",(function(){document.body.clientWidth>=768&&sidebar.classList.remove("mostrar")})),$(document).ready((function(){actListChat()}));var baseDir="http://localhost:3000/adminChat-v3/";async function actListChat(){await sleep(500),console.log("aeaaaa");var e=baseDir+"listChats";$.ajax({type:"GET",url:e,success:function(e){for(let t=0;t<document.getElementsByClassName("list-chat").length;t++)listBefore!=e&&(document.getElementsByClassName("list-chat")[t].innerHTML=e,listBefore=e),actListChat()}})}function chatModify(e){openUpdating(e)}function chatDelete(e){if(console.log("deleteChat.php?name="+e),1==confirm("¿Quieres eliminar el chat: "+e+"?")){var t=baseDir+"deleteChat?name="+e;$.ajax({type:"GET",url:t,success:function(e){console.log(e)}})}}function chatCreate(){openCreating()}let dic_users={};function deleteUser(e,t){delete dic_users[e],0==t?actUsersCreating():1==t&&actUsersUpdating()}function deleteAllUsers(e){for(const t in dic_users)deleteUser(t,e)}function addUser(e){var t="";0==e?t=baseDir+"addSelectedName?id="+document.getElementById("select-name-creating-chat").value:1==e&&(t=baseDir+"addSelectedName?id="+document.getElementById("select-name-updating-chat").value),t+="&view="+e,$.ajax({type:"GET",url:t,success:function(t){0==e?(dic_users[document.getElementById("select-name-creating-chat").value]=t,actUsersCreating()):(e=1)&&(dic_users[document.getElementById("select-name-updating-chat").value]=t,actUsersUpdating())}})}function openCreating(){document.getElementById("creating-chat").hidden=!1}function closeCreating(){deleteAllUsers(0),document.getElementById("txt-chat-name-creating-chat").value="",document.getElementById("creating-chat").hidden=!0}function actUsersCreating(){document.getElementById("list-names-creating-chat").innerHTML="";for(const e in dic_users)document.getElementById("list-names-creating-chat").innerHTML+=dic_users[e]}function cancelCreating(){closeCreating()}function acceptCreating(){let e=[],t=!0;for(const n in dic_users)t&&(t=!1),e.push(n);if(t)alert("No hay usuarios registrados");else{{let t=document.getElementById("txt-chat-name-creating-chat").value;var n=baseDir+"createChat?name="+t+"&users=,";if(""==t.trim())return void alert("Nombre de grupo vacío");for(let t=0;t<e.length;t++)n+=e[t]+",";$.ajax({type:"GET",url:n,success:function(e){console.log(e)}})}closeCreating()}}var val,baseName="";function openUpdating(e){baseName=e,document.getElementById("updating-chat").hidden=!1,document.getElementById("txt-chat-name-updating-chat").value=e;var t=document.getElementsByClassName("item-list-chat-users-user-"+e);for(let e=0;e<t.length;e++){var n=baseDir+"addSelectedName?id="+t[e].value+"&view=1";$.ajax({type:"GET",url:n,success:function(n){dic_users[t[e].value]=n,actUsersUpdating()}})}}function closeUpdating(){deleteAllUsers(1),document.getElementById("txt-chat-name-updating-chat").value="",document.getElementById("updating-chat").hidden=!0}function actUsersUpdating(){document.getElementById("list-names-updating-chat").innerHTML="";for(const e in dic_users)document.getElementById("list-names-updating-chat").innerHTML+=dic_users[e]}function cancelUpdating(){closeUpdating()}function acceptUpdating(){let e=[],t=!0;for(const n in dic_users)t&&(t=!1),e.push(n);if(t)alert("No hay usuarios registrados");else{{let t=document.getElementById("txt-chat-name-updating-chat").value;var n=baseDir+"updateChat?name="+baseName+"&nName="+t+"&users=,";if(""==t.trim())return void alert("Nombre de grupo vacío");for(let t=0;t<e.length;t++)n+=e[t]+",";$.ajax({type:"GET",url:n,success:function(e){console.log(e)}})}closeUpdating()}}var baseChat="http://localhost:3000/chat-v3/",isActive=!1;async function actChat(){await sleep(500);var e=baseChat;e+=null!=document.getElementsByClassName("chat")[0].getAttribute("id")?"divChat?id="+document.getElementsByClassName("chat")[0].getAttribute("id"):"divChat",$.ajax({type:"GET",url:e,success:function(e){for(let t=0;t<document.getElementsByClassName("content-box-chat").length;t++)document.getElementsByClassName("content-box-chat")[t].innerHTML=e;actChat()}})}function changeContentBoxActive(){isActive=!isActive;for(let e=0;e<document.getElementsByClassName("box-chat").length;e++)isActive?document.getElementsByClassName("box-chat")[e].setAttribute("isactive","true"):document.getElementsByClassName("box-chat")[e].setAttribute("isactive","false")}$(document).ready((function(){actChat(),actSelectedChat(),document.getElementById("img-chat").addEventListener("click",changeContentBoxActive),document.getElementById("close-chat").addEventListener("click",changeContentBoxActive),document.getElementById("close-sending-chat").addEventListener("click",closeSending),document.getElementById("hide-sending-chat").addEventListener("click",hideSending),document.getElementById("btn-send-chat").addEventListener("click",sendMessage)}));var actName=null,lastData=null;function selectChat(e,t=!0){document.getElementById("name-sending-chat").textContent=e;var n=baseChat+"sendingChat?id="+document.getElementsByClassName("chat")[0].getAttribute("id")+"&name="+e;for(let e=0;e<document.getElementsByClassName("sending-chat").length;e++)document.getElementsByClassName("sending-chat")[e].setAttribute("active",""),t&&document.getElementsByClassName("sending-chat")[e].removeAttribute("hide");$.ajax({type:"GET",url:n,success:function(e){for(let t=0;t<document.getElementsByClassName("content-sending-chat").length;t++)if(lastData!=e){lastData=e,document.getElementsByClassName("content-sending-chat")[t].innerHTML=lastData;let n=document.getElementsByClassName("content-sending-chat")[0];n.scrollTo(0,n.scrollHeight)}}}),actName=e}function closeSending(){actName=null;for(let e=0;e<document.getElementsByClassName("sending-chat").length;e++)document.getElementsByClassName("sending-chat")[e].removeAttribute("active"),document.getElementsByClassName("sending-chat")[e].removeAttribute("hide");for(let e=0;e<document.getElementsByClassName("content-sending-chat").length;e++)document.getElementsByClassName("content-sending-chat")[e].innerHTML=null,lastData=null}function hideSending(){for(let e=0;e<document.getElementsByClassName("sending-chat").length;e++)document.getElementsByClassName("sending-chat")[e].hasAttribute("hide")?document.getElementsByClassName("sending-chat")[e].removeAttribute("hide"):document.getElementsByClassName("sending-chat")[e].setAttribute("hide","")}async function actSelectedChat(){await sleep(500),null!=actName&&selectChat(actName,!1),actSelectedChat()}function sendMessage(){if(""!=document.getElementById("txt-send-chat").value.trim()){let t=document.getElementById("txt-send-chat").value.trim();var e=baseChat+"sendMessage?name="+document.getElementById("name-sending-chat").innerText+"&id="+document.getElementsByClassName("chat")[0].getAttribute("id")+"&msg="+t;console.log(e),$.ajax({type:"GET",url:e,success:function(e){selectChat(actName,!1)}})}document.getElementById("txt-send-chat").value=""}